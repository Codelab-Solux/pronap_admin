{% extends 'main.html' %} {% load static %}
<!--  -->
{% block content %}
<div class="w-full max-w-7xl mx-auto flex flex-col justify-between gap-6">
  <div class="flex justify-between">
    <a
      id="back-button"
      class="inline-block px-3 py-2 text-white bg-green-700 hover:bg-green-900 rounded-lg transition-all duration-300"
      href="#"
      >&larr;</a
    >
    <span
      class="flex items-center gap-4 py-2 px-4 rounded-lg bg-lime-200 text-black text-sm"
      ><i class="fa-solid fa-tags"></i>
      <!--  -->
      Vente N° : 000{{ curr_obj.id }}</span
    >
  </div>

  <div class="flex gap-4">
    <!-- cart details -->
    <div class="overflow-x-auto w-full overflow-y-hidden rounded-xl">
      <table id="items_table" class="w-full text-left db-table">
        <thead class="bg-green-700 border border-green-900 text-white">
          <tr>
            <th class="px-3 py-4 text-sm">Image</th>
            <th class="px-3 py-4 text-sm">Article</th>
            <th class="px-3 py-4 text-sm">Prix unitaire</th>
            <th class="px-3 py-4 text-sm text-center">Quantité</th>
            <th class="px-3 py-4 text-sm text-center">Total</th>
          </tr>
        </thead>

        <tbody class="border">
          {% for obj in sale_items %}
          <tr
            class="text-gray-600 border text-sm hover:bg-white hover:text-black transition-all duration-300"
          >
            <td class="px-3 py-1">
              {% if obj.product_stock.product.image %}
              <img
                class="h-7 text-gray-200"
                src="{{obj.product_stock.product.image.url}}"
                alt="item image"
              />
              {% else %}
              <img
                class="h-7 text-gray-200"
                src="{% static 'imgs/logo.png' %}"
                alt="image"
              />
              {% endif %}
            </td>
            <td class="px-3 py-1">{{obj.product_stock.product.name}}</td>
            {% if obj.product_stock.is_promoted %}
            <td class="px-3 py-1">
              {{obj.product_stock.promo_price}} Cfa/{{
              obj.product_stock.product.get_unit_display }}
            </td>
            {% else %}
            <td class="px-3 py-1">
              {{ obj.product_stock.price }} Cfa/
              <!--  -->
              {{ obj.product_stock.product.get_unit_display }}
            </td>
            {% endif %}
            <td class="px-3 py-1 text-center">{{ obj.quantity }}</td>
            <td class="px-3 py-1 text-center">{{ obj.get_total }} Cfa</td>
          </tr>
          <input type="hidden" id="csrf_token" value="{{ csrf_token }}" />
          {% endfor %}
        </tbody>
      </table>
    </div>
    <!--  -->
      <div
        class="p-4 w-full max-w-60 xl:max-w-80 flex flex-col justify-center gap-2 bg-orange-100 rounded-xl"
      >
        <p>Client : <b>{{ curr_obj.buyer.name }}</b></p>
        <p>Articles : <b>{{ sale_items|length }}</b></p>
        <p>Total : <b>{{ curr_obj.total }} Cfa</b></p>
        <p>Remise : <b>{{ curr_obj.discount }} Cfa</b></p>
        <p>Caisse : <b>{{ curr_obj.cashdesk.name }}</b></p>
        <p>Date : <b>{{ curr_obj.timestamp.date }}</b></p>
        <p>Audit : {% include 'base/components/audit_status.html' %}</p>
      </div>
  </div>
</div>

<script>
  //  go back one page ----------------------------------------------------------------------------------------------------
  backBtn = document.getElementById("back-button");

  backBtn.addEventListener("click", function (event) {
    event.preventDefault(); // Prevent the default anchor behavior
    window.history.go(-1); // Go back two pages
  });
</script>
{% endblock %}
